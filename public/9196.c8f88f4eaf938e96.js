"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9196],{9196:(A,I,d)=>{d.r(I),d.d(I,{Tab2PageModule:()=>N});var i=d(5056),T=d(9808),b=d(4182),Z=d(581),y=d(8808),u=d(655),e=d(9863),_=d(3442);function O(n,c){if(1&n&&(e.TgZ(0,"ion-label")(1,"h2"),e._uU(2),e.qZA(),e.TgZ(3,"p"),e._uU(4),e.qZA()()),2&n){const t=e.oxw();e.xp6(2),e.Oqu(t.salones[t.contador].nombre),e.xp6(2),e.Oqu(t.salones[t.contador].ubicacion)}}function C(n,c){if(1&n&&e._UZ(0,"ion-datetime",17),2&n){const t=e.oxw();e.s9C("value",t.fechaFormateadaI)}}function M(n,c){if(1&n&&e._UZ(0,"ion-datetime",18),2&n){const t=e.oxw();e.s9C("value",t.fechaFormateadaF)}}const P=[{path:"",component:(()=>{class n{constructor(t,o){this.alertController=t,this.reservarService=o,this.GetSalones(),this.fecha=new Date,this.contador=0,this.fechaFormateadaI="2022-10-07T"+(this.fecha.getHours()<10?"0"+this.fecha.getHours():this.fecha.getHours())+":"+(this.fecha.getMinutes()<10?"0"+this.fecha.getMinutes():this.fecha.getMinutes())+":00-23:00",this.fechaFormateadaF="2022-10-07T"+(this.fecha.getHours()+1<10?"0"+(this.fecha.getHours()+1):this.fecha.getHours()+1)+":"+(this.fecha.getMinutes()<10?"0"+this.fecha.getMinutes():this.fecha.getMinutes())+":00-23:00"}ngOnInit(){this.GetSalones()}GetSalones(){return(0,u.mG)(this,void 0,void 0,function*(){yield this.reservarService.GetSalones().subscribe(o=>(0,u.mG)(this,void 0,void 0,function*(){this.salones=o}))})}CambiarSalonF(){this.contador+1==this.salones.length?this.contador=0:this.contador++}CambiarSalonR(){this.contador-1==-1?this.contador=this.salones.length-1:this.contador--}InfoCodigo(){return(0,u.mG)(this,void 0,void 0,function*(){this.VerificarOcupacion().then(()=>(0,u.mG)(this,void 0,void 0,function*(){if(this.banderaValidacionOcupado&&(yield this.VerificarInformacion()))if("Aguascalientes"==this.contrasena){let t=Math.floor(5e3*Math.random())+1;const o=yield this.alertController.create({header:"Codigo:"+t,message:"Guarde este codigo para realizar modificaciones",buttons:[{text:"OK",role:"confirm"}]});yield o.present(),yield o.onDidDismiss();let r=document.getElementById("fecha").value.substring(0,10),p=document.getElementById("datetime2").value.substring(11,16),s=document.getElementById("datetime1").value.substring(11,16);(yield this.reservarService.Guardar(this.nombreReservante,r,p,s,this.grupo,this.salones[this.contador].id,t)).subscribe(f=>(0,u.mG)(this,void 0,void 0,function*(){if(f){const h=yield this.alertController.create({header:"Reservaci\xf3n exitosa",buttons:[{text:"OK",role:"confirm"}]});yield h.present(),yield h.onDidDismiss(),this.nombreReservante="",this.grupo="",this.contrasena="",document.getElementById("fecha").value=""}}))}else{const t=yield this.alertController.create({header:"Contrase\xf1a Incorrecta",message:"Solicite contrase\xf1a al administrador",buttons:[{text:"OK",role:"confirm"}]});yield t.present(),yield t.onDidDismiss()}}))})}VerificarOcupacion(){return(0,u.mG)(this,void 0,void 0,function*(){return new Promise((t,o)=>(0,u.mG)(this,void 0,void 0,function*(){if(null==document.getElementById("fecha").value){const a=yield this.alertController.create({header:"Error ",message:"Seleccione fecha",buttons:[{text:"OK",role:"confirm"}]});return yield a.present(),yield a.onDidDismiss(),!1}{let a=document.getElementById("fecha").value.substring(0,10),r=yield this.reservarService.getReservacionesSalonFecha(this.salones[this.contador].id,a);try{r.subscribe(p=>(0,u.mG)(this,void 0,void 0,function*(){let s=p;if(0==s.length)this.banderaValidacionOcupado=!0,t();else{let m=Number.parseInt(document.getElementById("datetime2").value.substring(11,13)),f=Number.parseInt(document.getElementById("datetime2").value.substring(14,16)),h=Number.parseInt(document.getElementById("datetime1").value.substring(11,13)),v=Number.parseInt(document.getElementById("datetime1").value.substring(14,16));if(this.ValidarHoras(m,f,h,v)){let g=!1;this.banderOcupado=!1;for(let l=0;l<s.length;l++)m==Number.parseInt(s[l].horaI.substring(0,2))&&f>=Number.parseInt(s[l].horaI.substring(3,5))&&(this.banderOcupado=!0),m>Number.parseInt(s[l].horaI.substring(0,2))&&m<Number.parseInt(s[l].horaF.substring(0,2))&&(this.banderOcupado=!0),m==Number.parseInt(s[l].horaF.substring(0,2))&&f<Number.parseInt(s[l].horaF.substring(3,5))&&(this.banderOcupado=!0),this.banderOcupado||m>=Number.parseInt(s[l].horaF.substring(0,2))||(h==Number.parseInt(s[l].horaI.substring(0,2))&&v>Number.parseInt(s[l].horaI.substring(3,5))&&(g=!0),h>Number.parseInt(s[l].horaI.substring(0,2))&&(g=!0));this.banderOcupado?document.getElementById("InicioOcupado").classList.remove("d-none"):document.getElementById("InicioOcupado").classList.contains("d-none")?document.getElementById("InicioOcupado"):document.getElementById("InicioOcupado").classList.add("d-none"),g?document.getElementById("FinOcupado").classList.remove("d-none"):document.getElementById("FinOcupado").classList.contains("d-none")?document.getElementById("FinOcupado"):document.getElementById("FinOcupado").classList.add("d-none"),this.banderaValidacionOcupado=!g&&!this.banderOcupado,t()}else{const g=yield this.alertController.create({header:"Error",message:"Hora de finalizaci\xf3n menor o igual a la hora de Inicio.",buttons:[{text:"OK",role:"confirm"}]});yield g.present(),yield g.onDidDismiss(),this.banderaValidacionOcupado=!1,t()}}}))}catch(p){t()}}}))})}ValidarHoras(t,o,a,r){return!(t>a||t==a&&o>=r)}VerificarInformacion(){return(0,u.mG)(this,void 0,void 0,function*(){if(""==this.grupo||null==this.grupo&&""==this.nombreReservante||null==this.nombreReservante){const t=yield this.alertController.create({header:"Datos incompletos",message:"Verifique que todos los campos esten cubiertos",buttons:[{text:"OK",role:"confirm"}]});return yield t.present(),yield t.onDidDismiss(),!1}return!0})}doRefresh(t){setTimeout(()=>{this.GetSalones(),location.reload(),t.target.complete()},1e3)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(i.Br),e.Y36(_.Q))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-tab2"]],viewQuery:function(t,o){if(1&t&&e.Gf(i.ki,5),2&t){let a;e.iGM(a=e.CRH())&&(o.modal3=a.first)}},decls:49,vars:8,consts:[[3,"translucent"],["id","Header"],["fill","clear",3,"click"],["name","chevron-back-outline"],[4,"ngIf"],["name","chevron-forward-outline"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[3,"ngModel","ngModelChange"],["presentation","date","name","fecha","id","fecha"],["slot","start","color","danger","id","InicioOcupado",1,"d-none"],["datetime","datetime2"],[3,"keepContentsMounted"],["slot","start","color","danger","id","FinOcupado",1,"d-none"],["datetime","datetime1"],["type","password","placeholder","Contrase\xf1a de administrador",3,"ngModel","ngModelChange"],["expand","block",3,"click"],["id","datetime2","presentation","time","name","HoraInicioR",3,"value"],["id","datetime1","presentation","time","name","HoraFinR",3,"value"]],template:function(t,o){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e._uU(3," Reservar "),e.qZA(),e.TgZ(4,"ion-grid",1)(5,"ion-row")(6,"ion-col")(7,"ion-button",2),e.NdJ("click",function(){return o.CambiarSalonR()}),e._UZ(8,"ion-icon",3),e.qZA()(),e.TgZ(9,"ion-col"),e.YNc(10,O,5,2,"ion-label",4),e.qZA(),e.TgZ(11,"ion-col")(12,"ion-button",2),e.NdJ("click",function(){return o.CambiarSalonF()}),e._UZ(13,"ion-icon",5),e.qZA()()()()()(),e.TgZ(14,"ion-content",6)(15,"ion-refresher",7),e.NdJ("ionRefresh",function(r){return o.doRefresh(r)}),e._UZ(16,"ion-refresher-content"),e.qZA(),e.TgZ(17,"ion-item")(18,"ion-label"),e._uU(19,"Nombre de qui\xe9n reserva"),e.qZA(),e.TgZ(20,"ion-input",8),e.NdJ("ngModelChange",function(r){return o.nombreReservante=r}),e.qZA()(),e.TgZ(21,"ion-item"),e._UZ(22,"ion-datetime",9),e.qZA(),e.TgZ(23,"ion-item")(24,"ion-badge",10),e._uU(25,"Hora Ocupada"),e.qZA(),e.TgZ(26,"ion-label"),e._uU(27,"Hora de Inicio"),e.qZA(),e._UZ(28,"ion-datetime-button",11),e.TgZ(29,"ion-modal",12),e.YNc(30,C,1,1,"ng-template"),e.qZA()(),e.TgZ(31,"ion-item")(32,"ion-badge",13),e._uU(33,"Hora Ocupada"),e.qZA(),e.TgZ(34,"ion-label"),e._uU(35,"Hora de Fin"),e.qZA(),e._UZ(36,"ion-datetime-button",14),e.TgZ(37,"ion-modal",12),e.YNc(38,M,1,1,"ng-template"),e.qZA()(),e.TgZ(39,"ion-item")(40,"ion-label"),e._uU(41,"Grupo"),e.qZA(),e.TgZ(42,"ion-input",8),e.NdJ("ngModelChange",function(r){return o.grupo=r}),e.qZA()(),e.TgZ(43,"ion-item")(44,"ion-label"),e._uU(45,"Contrase\xf1a:"),e.qZA(),e.TgZ(46,"ion-input",15),e.NdJ("ngModelChange",function(r){return o.contrasena=r}),e.qZA()(),e.TgZ(47,"ion-button",16),e.NdJ("click",function(){return o.InfoCodigo()}),e._uU(48,"Reservar"),e.qZA()()),2&t&&(e.Q6J("translucent",!0),e.xp6(10),e.Q6J("ngIf",null!=o.salones),e.xp6(4),e.Q6J("fullscreen",!0),e.xp6(6),e.Q6J("ngModel",o.nombreReservante),e.xp6(9),e.Q6J("keepContentsMounted",!0),e.xp6(8),e.Q6J("keepContentsMounted",!0),e.xp6(5),e.Q6J("ngModel",o.grupo),e.xp6(4),e.Q6J("ngModel",o.contrasena))},dependencies:[i.yp,i.YG,i.wI,i.W2,i.x4,i.Mj,i.jY,i.Gu,i.gu,i.pK,i.Ie,i.Q$,i.nJ,i.Wo,i.Nd,i.wd,i.sr,i.ki,i.QI,i.j9,T.O5,b.JJ,b.On],styles:["ion-item[_ngcontent-%COMP%]{padding-top:.5em}.Hora[_ngcontent-%COMP%]{height:50%;padding-top:0}ion-button[_ngcontent-%COMP%]{padding-top:1em}.d-none[_ngcontent-%COMP%]{display:none}"]}),n})()}];let F=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[y.Bz.forChild(P),y.Bz]}),n})(),N=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[i.Pc,T.ez,b.u5,Z.e,F]}),n})()}}]);